<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="1441px" height="819px" viewBox="-0.5 -0.5 1441 819" content="&lt;mxfile host=&quot;drawio-plugin&quot; modified=&quot;2021-12-14T07:21:24.916Z&quot; agent=&quot;5.0 (Macintosh; Intel Mac OS X 12_0_1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.114 Safari/537.36&quot; etag=&quot;w9JGxk4rjYOqoWb6PS1P&quot; version=&quot;14.7.4&quot; type=&quot;embed&quot;&gt;&lt;diagram id=&quot;23iRSUPoRavnBvh4doch&quot; name=&quot;NonRecursiveMutex_fix&quot;&gt;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&lt;/diagram&gt;&lt;/mxfile&gt;"><defs/><g><ellipse cx="445" cy="417.5" rx="45" ry="30" fill="#ffffff" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 88px; height: 1px; padding-top: 418px; margin-left: 401px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">object1</div></div></div></foreignObject><text x="445" y="421" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">object1</text></switch></g><rect x="240" y="400" width="100" height="70" fill="#ffffff" stroke="#000000" pointer-events="all"/><path d="M 240 435 L 340 435" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><path d="M 240 400 M 340 400 M 340 435 M 240 435" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 240 400 M 340 400 M 340 435 M 240 435" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 98px; height: 1px; padding-top: 418px; margin-left: 241px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; max-height: 31px; overflow: hidden; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">pointer</div></div></div></foreignObject><text x="290" y="421" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">pointer</text></switch></g><path d="M 240 435 M 340 435 M 340 470 M 240 470" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 240 435 M 340 435 M 340 470 M 240 470" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 98px; height: 1px; padding-top: 453px; margin-left: 241px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; max-height: 31px; overflow: hidden; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">count = 2</div></div></div></foreignObject><text x="290" y="456" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">count = 2</text></switch></g><path d="M 160 375 L 200 375 L 200 417.5 L 233.63 417.5" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 238.88 417.5 L 231.88 421 L 233.63 417.5 L 231.88 414 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="80" y="360" width="80" height="30" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 78px; height: 1px; padding-top: 375px; margin-left: 81px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">globalPtr</div></div></div></foreignObject><text x="120" y="379" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">globalPtr</text></switch></g><path d="M 160 455 L 200 455 L 200 417.5 L 233.63 417.5" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 238.88 417.5 L 231.88 421 L 233.63 417.5 L 231.88 414 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="80" y="440" width="80" height="30" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 78px; height: 1px; padding-top: 455px; margin-left: 81px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">localPtr</div></div></div></foreignObject><text x="120" y="459" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">localPtr</text></switch></g><path d="M 340 417.5 L 393.63 417.5" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 398.88 417.5 L 391.88 421 L 393.63 417.5 L 391.88 414 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><ellipse cx="445" cy="752.5" rx="45" ry="30" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 88px; height: 1px; padding-top: 753px; margin-left: 401px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">object2</div></div></div></foreignObject><text x="445" y="756" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">object2</text></switch></g><rect x="240" y="625" width="100" height="70" fill="#ffffff" stroke="#000000" pointer-events="none"/><path d="M 240 660 L 340 660" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 240 625 M 340 625 M 340 660 M 240 660" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 240 625 M 340 625 M 340 660 M 240 660" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 98px; height: 1px; padding-top: 643px; margin-left: 241px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; max-height: 31px; overflow: hidden; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">pointer</div></div></div></foreignObject><text x="290" y="646" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">pointer</text></switch></g><path d="M 240 660 M 340 660 M 340 695 M 240 695" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 240 660 M 340 660 M 340 695 M 240 695" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 98px; height: 1px; padding-top: 678px; margin-left: 241px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; max-height: 31px; overflow: hidden; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">count = 1</div></div></div></foreignObject><text x="290" y="681" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">count = 1</text></switch></g><path d="M 160 642.5 L 233.63 642.5" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 238.88 642.5 L 231.88 646 L 233.63 642.5 L 231.88 639 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="80" y="627.5" width="80" height="30" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 78px; height: 1px; padding-top: 643px; margin-left: 81px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">localPtr</div></div></div></foreignObject><text x="120" y="646" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">localPtr</text></switch></g><path d="M 340 642.5 L 393.63 642.5" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 398.88 642.5 L 391.88 646 L 393.63 642.5 L 391.88 639 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 410px; margin-left: 20px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; white-space: nowrap; ">read</div></div></div></foreignObject><text x="20" y="414" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">read</text></switch></g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 708px; margin-left: 20px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; white-space: nowrap; ">write</div></div></div></foreignObject><text x="20" y="711" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">write</text></switch></g><rect x="240" y="735" width="100" height="70" fill="#ffffff" stroke="#000000" pointer-events="none"/><path d="M 240 770 L 340 770" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 240 735 M 340 735 M 340 770 M 240 770" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 240 735 M 340 735 M 340 770 M 240 770" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 98px; height: 1px; padding-top: 753px; margin-left: 241px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; max-height: 31px; overflow: hidden; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">pointer</div></div></div></foreignObject><text x="290" y="756" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">pointer</text></switch></g><path d="M 240 770 M 340 770 M 340 805 M 240 805" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 240 770 M 340 770 M 340 805 M 240 805" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 98px; height: 1px; padding-top: 788px; margin-left: 241px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; max-height: 31px; overflow: hidden; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">count = 1</div></div></div></foreignObject><text x="290" y="791" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">count = 1</text></switch></g><path d="M 160 752.5 L 233.63 752.5" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 238.88 752.5 L 231.88 756 L 233.63 752.5 L 231.88 749 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="80" y="737.5" width="80" height="30" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 78px; height: 1px; padding-top: 753px; margin-left: 81px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">globalPtr</div></div></div></foreignObject><text x="120" y="756" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">globalPtr</text></switch></g><path d="M 340 752.5 L 393.63 752.5" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 398.88 752.5 L 391.88 756 L 393.63 752.5 L 391.88 749 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><ellipse cx="445" cy="642.5" rx="45" ry="30" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 88px; height: 1px; padding-top: 643px; margin-left: 401px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">object1</div></div></div></foreignObject><text x="445" y="646" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">object1</text></switch></g><path d="M 60 350 L 55 350 Q 50 350 50 360 L 50 400 Q 50 410 45 410 L 42.5 410 Q 40 410 45 410 L 47.5 410 Q 50 410 50 420 L 50 460 Q 50 470 55 470 L 60 470" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 60 600 L 55 600 Q 50 600 50 610 L 50 697.5 Q 50 707.5 45 707.5 L 42.5 707.5 Q 40 707.5 45 707.5 L 47.5 707.5 Q 50 707.5 50 717.5 L 50 805 Q 50 815 55 815 L 60 815" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 298px; height: 1px; padding-top: 387px; margin-left: 522px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; "><div id="_SJ5jTEjm" class="editor-block code-line-block focused"><div class="block-content text-element"><span class="editor-text-node">void </span><span class="style-token style-function">read</span><span class="style-token style-punctuation">(</span><span class="style-token style-punctuation">)</span><span class="editor-text-node"> </span><span class="style-token style-punctuation">{</span></div></div><div id="_Uoc4uWF9" class="editor-block code-line-block"><div class="block-content text-element"><span class="editor-text-node">    shared_ptr </span><span class="style-token style-operator">&lt;</span><span class="editor-text-node">Foo</span><span class="style-token style-operator">&gt;</span><span class="editor-text-node"> localPtr</span><span class="style-token style-punctuation">;</span></div></div><div id="_H6IhvZpO" class="editor-block code-line-block"><div class="block-content text-element"><span class="editor-text-node">    </span><span class="style-token style-punctuation">{</span></div></div><div id="_8XcUF5yM" class="editor-block code-line-block"><div class="block-content text-element"><span class="editor-text-node">        MutexLockGuard </span><span class="style-token style-function">lock</span><span class="style-token style-punctuation">(</span><span class="editor-text-node">mutex</span><span class="style-token style-punctuation">)</span><span class="style-token style-punctuation">;</span></div></div><div id="_kg8oqRZZ" class="editor-block code-line-block"><div class="block-content text-element"><span class="editor-text-node">        localPtr </span><span class="style-token style-operator">=</span><span class="editor-text-node"> globalPtr</span><span class="style-token style-punctuation">;</span><span class="editor-text-node">  </span><span class="style-token style-comment">// read globalPtr</span></div></div><div id="_yDrGw_O_" class="editor-block code-line-block"><div class="block-content text-element"><span class="editor-text-node">    </span><span class="style-token style-punctuation">}</span></div></div><div id="_zPgsTH9t" class="editor-block code-line-block"><div class="block-content text-element"><span class="editor-text-node">    </span><span class="style-token style-comment">// use localPtr since here，读写localPtr也无须加锁</span></div></div><div id="_w1oGkKbm" class="editor-block code-line-block"><div class="block-content text-element"><span class="editor-text-node">    </span><span class="style-token style-function">doit</span><span class="style-token style-punctuation">(</span><span class="editor-text-node">localPtr</span><span class="style-token style-punctuation">)</span><span class="style-token style-punctuation">;</span></div></div><div id="_L4IhuJMb" class="editor-block code-line-block"><div class="block-content text-element"><span class="style-token style-punctuation">}</span></div></div></div></div></div></foreignObject><text x="522" y="399" fill="#000000" font-family="Helvetica" font-size="12px">void read() {...</text></switch></g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 418px; height: 1px; padding-top: 632px; margin-left: 522px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; "><div id="_81poGPYq" class="editor-block code-line-block focused"><div class="block-content text-element"><span class="editor-text-node">void </span><span class="style-token style-function">write</span><span class="style-token style-punctuation">(</span><span class="style-token style-punctuation">)</span><span class="editor-text-node"> </span><span class="style-token style-punctuation">{</span></div></div><div id="_druir53n" class="editor-block code-line-block"><div class="block-content text-element"><span class="editor-text-node">    shared_ptr </span><span class="style-token style-operator">&lt;</span><span class="editor-text-node">Foo</span><span class="style-token style-operator">&gt;</span><span class="editor-text-node"> </span><span class="style-token style-function">newPtr</span><span class="style-token style-punctuation">(</span><span class="style-token style-keyword">new</span><span class="editor-text-node"> </span><span class="style-token style-class-name">Foo</span><span class="style-token style-punctuation">)</span><span class="style-token style-punctuation">;</span><span class="editor-text-node">  </span><span class="style-token style-comment">// 注意，对象的创建在临界区之外  </span></div></div><div id="_Ldo4Wt1O" class="editor-block code-line-block"><div class="block-content text-element"><span class="editor-text-node">    </span><span class="style-token style-punctuation">{</span></div></div><div id="_stZJLjs1" class="editor-block code-line-block"><div class="block-content text-element"><span class="editor-text-node">        MutexLockGuard </span><span class="style-token style-function">lock</span><span class="style-token style-punctuation">(</span><span class="editor-text-node">mutex</span><span class="style-token style-punctuation">)</span><span class="style-token style-punctuation">;</span></div></div><div id="_VUOhazBI" class="editor-block code-line-block"><div class="block-content text-element"><span class="editor-text-node">        globalPtr </span><span class="style-token style-operator">=</span><span class="editor-text-node"> newPtr</span><span class="style-token style-punctuation">;</span><span class="editor-text-node">  </span><span class="style-token style-comment">// write to globalPtr  </span></div></div><div id="_1L0tDEEv" class="editor-block code-line-block"><div class="block-content text-element"><span class="editor-text-node">    </span><span class="style-token style-punctuation">}</span><span class="editor-text-node">  </span></div></div><div id="_C0KR1atF" class="editor-block code-line-block"><div class="block-content text-element"><span class="editor-text-node">    </span><span class="style-token style-comment">// use newPtr since here，读写newPtr无须加锁</span></div></div><div id="_Kx1oVnSd" class="editor-block code-line-block"><div class="block-content text-element"><span class="editor-text-node">    </span><span class="style-token style-function">doit</span><span class="style-token style-punctuation">(</span><span class="editor-text-node">newPtr</span><span class="style-token style-punctuation">)</span><span class="style-token style-punctuation">;</span></div></div><div id="_YLCyyiVH" class="editor-block code-line-block"><div class="block-content text-element"><span class="style-token style-punctuation">}</span></div></div></div></div></div></foreignObject><text x="522" y="644" fill="#000000" font-family="Helvetica" font-size="12px">void write() {...</text></switch></g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 298px; height: 1px; padding-top: 207px; margin-left: 522px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; "><div id="_2y_aZpqN" class="editor-block code-line-block hover focused"><div class="block-content text-element"><span class="editor-text-node">MutexLock mutex</span><span class="style-token style-punctuation">;</span><span class="editor-text-node"> </span><span class="style-token style-comment">// No need for ReaderWriterLock</span></div></div><div id="_OJqBLW4E" class="editor-block code-line-block"><div class="block-content text-element"><span class="editor-text-node">shared_ptr</span><span class="style-token style-operator">&lt;</span><span class="editor-text-node">Foo</span><span class="style-token style-operator">&gt;</span><span class="editor-text-node"> globalPtr</span><span class="style-token style-punctuation">;</span></div></div><div id="_x0W2XdBA" class="editor-block code-line-block empty-block"><div class="block-content text-element"><br /></div></div><div id="_FiBDJkoQ" class="editor-block code-line-block"><div class="block-content text-element"><span class="style-token style-comment">// 我们的任务是把 globalPtr 安全地传给 doit()</span></div></div><div id="_OXJ4Wcr9" class="editor-block code-line-block"><div class="block-content text-element"><span class="editor-text-node">void </span><span class="style-token style-function">doit</span><span class="style-token style-punctuation">(</span><span class="editor-text-node">const shared_ptr</span><span class="style-token style-operator">&lt;</span><span class="editor-text-node">Foo</span><span class="style-token style-operator">&gt;</span><span class="style-token style-operator">&amp;</span><span class="editor-text-node"> pFoo</span><span class="style-token style-punctuation">)</span><span class="style-token style-punctuation">;</span></div></div></div></div></div></foreignObject><text x="522" y="219" fill="#000000" font-family="Helvetica" font-size="12px">MutexLock mutex; // No need for ReaderWriterLock...</text></switch></g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 368px; height: 1px; padding-top: 7px; margin-left: 952px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; "><pre style="background-color: #2b2b2b ; color: #a9b7c6 ; font-family: &quot;jetbrains mono&quot; , monospace ; font-size: 9.8pt"><span style="color: #cc7832">class </span><span style="color: #b5b6e3">Foo<br /></span>{<br /> <span style="color: #cc7832">public</span>:<br />  <span style="color: #cc7832">void </span><span style="color: #ffc66d">doit</span>() <span style="color: #cc7832">const;<br /></span>}<span style="color: #cc7832">;<br /></span><span style="color: #cc7832"><br /></span><span style="color: #cc7832">typedef </span><span style="color: #b5b6e3">std</span>::<span style="color: #b5b6e3">vector</span>&lt;<span style="color: #b5b6e3">Foo</span>&gt; <span style="color: #b9bcd1">FooList</span><span style="color: #cc7832">;<br /></span><span style="color: #cc7832">typedef </span><span style="color: #b5b6e3">std</span>::<span style="color: #b5b6e3">shared_ptr</span>&lt;<span style="color: #b9bcd1">FooList</span>&gt; <span style="color: #b9bcd1">FooListPtr</span><span style="color: #cc7832">;<br /></span><span style="color: #b9bcd1">FooListPtr </span>g_foos<span style="color: #cc7832">;<br /></span><span style="color: #b5b6e3">MutexLock </span>mutex<span style="color: #cc7832">;</span></pre><pre style="background-color: #2b2b2b ; color: #a9b7c6 ; font-family: &quot;jetbrains mono&quot; , monospace ; font-size: 9.8pt"><span style="color: #cc7832"><br /></span></pre><pre style="background-color: #2b2b2b ; color: #a9b7c6 ; font-family: &quot;jetbrains mono&quot; , monospace ; font-size: 9.8pt"><pre style="font-family: &quot;jetbrains mono&quot; , monospace ; font-size: 9.8pt"><span style="color: #cc7832">void </span><span style="color: #b5b6e3">Foo</span>::<span style="color: #ffc66d">doit</span>() <span style="color: #cc7832">const </span>{<br />    <span style="color: #b5b6e3">Foo </span>f<span style="color: #cc7832">;<br /></span><span style="color: #cc7832">    </span>post(f)<span style="color: #cc7832">;<br /></span>}</pre></pre></div></div></div></foreignObject><text x="952" y="19" fill="#000000" font-family="Helvetica" font-size="12px">class Foo...</text></switch></g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 488px; height: 1px; padding-top: 317px; margin-left: 952px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; "><pre style="background-color: #2b2b2b ; color: #a9b7c6 ; font-family: &quot;jetbrains mono&quot; , monospace ; font-size: 9.8pt"><span style="color: #cc7832">void </span><span style="color: #ffc66d">traverse</span>()<br />{<br />  <span style="color: #b9bcd1">FooListPtr </span>foos<span style="color: #cc7832">;<br /></span><span style="color: #cc7832">  </span>{<br />    <span style="color: #b5b6e3">MutexLockGuard </span>lock(mutex)<span style="color: #cc7832">;<br /></span><span style="color: #cc7832">    </span>foos <span style="color: #5f8c8a">= </span>g_foos<span style="color: #cc7832">;<br /></span><span style="color: #cc7832">    </span><span style="color: #908b25">assert</span>(!g_foos.unique())<span style="color: #cc7832">;<br /></span><span style="color: #cc7832">  </span>}<br /><br />  <span style="color: #808080">// assert(!foos.unique()); this may not hold<br /></span><span style="color: #808080"><br /></span><span style="color: #808080">  </span><span style="color: #cc7832">for </span>(<span style="color: #b5b6e3">std</span>::<span style="color: #b5b6e3">vector</span>&lt;<span style="color: #b5b6e3">Foo</span>&gt;::<span style="color: #b9bcd1">const_iterator </span>it = foos<span style="color: #5f8c8a">-&gt;</span>begin()<span style="color: #cc7832">;<br /></span><span style="color: #cc7832">      </span>it <span style="color: #5f8c8a">!= </span>foos<span style="color: #5f8c8a">-&gt;</span>end()<span style="color: #cc7832">; </span><span style="color: #5f8c8a">++</span>it)<br />  {<br />    it<span style="color: #5f8c8a">-&gt;</span>doit()<span style="color: #cc7832">;<br /></span><span style="color: #cc7832">  </span>}<br />}</pre></div></div></div></foreignObject><text x="952" y="329" fill="#000000" font-family="Helvetica" font-size="12px">void traverse()...</text></switch></g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 488px; height: 1px; padding-top: 612px; margin-left: 952px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; "><pre style="background-color: #2b2b2b ; color: #a9b7c6 ; font-family: &quot;jetbrains mono&quot; , monospace ; font-size: 9.8pt"><span style="color: #cc7832">void </span><span style="color: #ffc66d">post</span>(<span style="color: #cc7832">const </span><span style="color: #b5b6e3">Foo</span>&amp; f)<br />{<br />  printf(<span style="color: #6a8759">"post</span><span style="color: #cc7832">\n</span><span style="color: #6a8759">"</span>)<span style="color: #cc7832">;<br /></span><span style="color: #cc7832">  </span><span style="color: #b5b6e3">MutexLockGuard </span>lock(mutex)<span style="color: #cc7832">;<br /></span><span style="color: #cc7832">  if </span>(!g_foos.unique())<br />  {<br />    g_foos.reset(<span style="color: #cc7832">new </span><span style="color: #b9bcd1">FooList</span>(<span style="color: #5f8c8a">*</span>g_foos))<span style="color: #cc7832">; </span><span style="color: #808080">// </span><span style="color: #808080 ; font-family: &quot;menlo-regular&quot; , monospace">复制了一份原始的数据<br /></span><span style="color: #808080 ; font-family: &quot;menlo-regular&quot; , monospace">    </span>printf(<span style="color: #6a8759">"copy the whole list</span><span style="color: #cc7832">\n</span><span style="color: #6a8759">"</span>)<span style="color: #cc7832">;<br /></span><span style="color: #cc7832">  </span>}<br />  <span style="color: #908b25">assert</span>(g_foos.unique())<span style="color: #cc7832">;<br /></span><span style="color: #cc7832">  </span>g_foos<span style="color: #5f8c8a">-&gt;</span>push_back(f)<span style="color: #cc7832">;<br /></span>}</pre></div></div></div></foreignObject><text x="952" y="624" fill="#000000" font-family="Helvetica" font-size="12px">void post(const Foo&amp; f)...</text></switch></g></g><switch><g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"/><a transform="translate(0,-5)" xlink:href="https://www.diagrams.net/doc/faq/svg-export-text-problems" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Viewer does not support full SVG 1.1</text></a></switch></svg>